<section>
  <div class="text-center title">
    <h2>Estadísticas de atención</h2>
    <br/>
  </div>

  <div class="page-header">
    <h3>Calificación del servicio</h3>
  </div>

  <div class="container">

    <div class="row">
      <div style="width: 32%" class="col-sm-3">
        <div class="rating-block">
          <h4>Calificación promedio de usuarios.</h4>
          <h2 class="bold padding-bottom-7" >{{vm.ratingAll/vm.rating ? vm.ratingAll/vm.rating : '0'}} <small>/ 5</small></h2>

          <button ng-show="vm.ratingAll/vm.rating>=1" type="button" class="btn btn-warning btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating>=2" type="button" class="btn btn-warning btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating>=3" type="button" class="btn btn-warning btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating>=4" type="button" class="btn btn-warning btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating>=5" type="button" class="btn btn-warning btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating<1" type="button" class="btn btn-default btn-grey btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating<2" type="button" class="btn btn-default btn-grey btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating<3" type="button" class="btn btn-default btn-grey btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating<4" type="button" class="btn btn-default btn-grey btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>

          <button ng-show="vm.ratingAll/vm.rating<5" type="button" class="btn btn-default btn-grey btn-sm" aria-label="Left Align">
            <span class="fa fa-star" aria-hidden="true"></span>
          </button>
        </div>
      </div>
      <div class="col-sm-3">
        <h4>Desglose por calificación</h4>
        <div class="pull-left">
          <div class="pull-left" style="width:35px; line-height:1;">
            <div style="height:9px; margin:5px 0;">5 <span class="fa fa-star"></span></div>
          </div>
          <div class="pull-left" style="width:180px;">
            <div class="progress" style="height:9px; margin:8px 0;">
              <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="5" style="width: {{vm.rating5*100/vm.rating}}%">
                <span class="sr-only">80% Complete (danger)</span>
              </div>
            </div>
          </div>
          <div class="pull-right" style="margin-left:10px;">{{vm.rating5}}</div>
        </div>
        <div class="pull-left">
          <div class="pull-left" style="width:35px; line-height:1;">
            <div style="height:9px; margin:5px 0;">4 <span class="fa fa-star"></span></div>
          </div>
          <div class="pull-left" style="width:180px;">
            <div class="progress" style="height:9px; margin:8px 0;">
              <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuenow="4" aria-valuemin="0" aria-valuemax="5" style="width: {{vm.rating4*100/vm.rating}}%">
                <span class="sr-only">80% Complete (danger)</span>
              </div>
            </div>
          </div>
          <div class="pull-right" style="margin-left:10px;">{{vm.rating4}}</div>
        </div>
        <div class="pull-left">
          <div class="pull-left" style="width:35px; line-height:1;">
            <div style="height:9px; margin:5px 0;">3 <span class="fa fa-star"></span></div>
          </div>
          <div class="pull-left" style="width:180px;">
            <div class="progress" style="height:9px; margin:8px 0;">
              <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="3" aria-valuemin="0" aria-valuemax="5" style="width: {{vm.rating3*100/vm.rating}}%">
                <span class="sr-only">80% Complete (danger)</span>
              </div>
            </div>
          </div>
          <div class="pull-right" style="margin-left:10px;">{{vm.rating3}}</div>
        </div>
        <div class="pull-left">
          <div class="pull-left" style="width:35px; line-height:1;">
            <div style="height:9px; margin:5px 0;">2 <span class="fa fa-star"></span></div>
          </div>
          <div class="pull-left" style="width:180px;">
            <div class="progress" style="height:9px; margin:8px 0;">
              <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: {{vm.rating2*100/vm.rating}}%">
                <span class="sr-only">80% Complete (danger)</span>
              </div>
            </div>
          </div>
          <div class="pull-right" style="margin-left:10px;">{{vm.rating2}}</div>
        </div>
        <div class="pull-left">
          <div class="pull-left" style="width:35px; line-height:1;">
            <div style="height:9px; margin:5px 0;">1 <span class="fa fa-star"></span></div>
          </div>
          <div class="pull-left" style="width:180px;">
            <div class="progress" style="height:9px; margin:8px 0;">
              <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="1" aria-valuemin="0" aria-valuemax="5" style="width: {{vm.rating1*100/vm.rating}}%">
                <span class="sr-only">80% Complete (danger)</span>
              </div>
            </div>
          </div>
          <div class="pull-right" style="margin-left:10px;">{{vm.rating1}}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="page-header">
    <h3 style="display: inline-block">
      Solicitudes de atención por status&nbsp;&nbsp;
    </h3>
    <a ui-sref="alarms.list">Ver listado de alarmas <i class="fa fa-chevron-circle-right"></i></a>
  </div>

  <div >
    <div class="row clearfix">
      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading red"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content red">
            <div class="circle-tile-description text-faded"> Esperando atención</div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsEsperando.length}}</div>
            <!--<a class="circle-tile-footer" ui-sref="alarms.list">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
            <br/>
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading green"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content green">
            <div class="circle-tile-description text-faded"> En atención </div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsEnAtencion.length}}</div>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
            <br/>
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading orange"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content orange">
            <div class="circle-tile-description text-faded"> Cancelado-organismo</div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsCancelado.length}}</div>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
            <br/>
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading yellow"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content yellow">
            <div class="circle-tile-description text-faded"> Cancelado-cliente </div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsCanceladoCliente.length}}</div>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
            <br/>
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading pink"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content pink">
            <div class="circle-tile-description text-faded"> Cancelados por la unidad</div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsCanceladoUnidad.length}}</div>
            <br/>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading blue"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content blue">
            <div class="circle-tile-description text-faded"> Rechazados</div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsRechazado.length}}</div>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
            <br/>
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading gray"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content gray">
            <div class="circle-tile-description text-faded"> Atendidos </div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsAtendido.length}}</div>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
            <br/>
          </div>
        </div>
      </div>

      <div class="col-md-3 column">
        <div class="circle-tile ">
          <a href="#"><div class="circle-tile-heading purple"><i class="fa fa-users fa-fw fa-3x"></i></div></a>
          <div class="circle-tile-content purple">
            <div class="circle-tile-description text-faded"> Pendiente por calificación</div>
            <div class="circle-tile-number text-faded ">{{vm.alarmsSinCalificar.length}}</div>
            <br/>
            <!--<a class="circle-tile-footer" href="#">More Info <i class="fa fa-chevron-circle-right"></i></a>-->
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="page-header">
    <h3>Historia de atención</h3>
  </div>

  <div style="margin-bottom: 20px;" class="card card-nav-tabs card-plain">
    <div style="height: 12vh;" class="header header-info">
      <!-- colors: "header-primary", "header-info", "header-success", "header-warning", "header-danger" -->
      <div class="nav-tabs-navigation">
        <div class="nav-tabs-wrapper">
          <ul class="nav nav-tabs" data-tabs="tabs">
            <li class="active"><a href="#organismo" data-toggle="tab"> Del organismo</a></li>
            <li><a href="#networksAll" data-toggle="tab" ng-click="vm.networksAll()"> Unidades de atención</a></li>
            <li><a href="#cliente" data-toggle="tab">Por cliente</a></li>
            <li><a href="#network" data-toggle="tab">Por unidad de atención</a></li>
            <li><a href="#periodo" data-toggle="tab">Por periodo</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div>
      <div class="tab-content">
        <div class="tab-pane active" id="organismo">
          <div class="scrollbar-log" id="style-6">
            <div class="force-overflow">
              <table ng-show="vm.log" class="table table-hover">
                <thead>
                <tr>
                  <th>Identificador</th>
                  <th>Fecha</th>
                  <th>Cliente</th>
                  <th>Descripción</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="log in vm.log">
                  <td>{{log._id}}</td>
                  <td>{{log.created | date:'medium'}}</td>
                  <td>{{log.clientEmail}}</td>
                  <td>{{log.description}}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="tab-pane" id="cliente">
          <div class="scrollbar-log" id="style-6">
            <div class="force-overflow">
              <div style="margin: 0px 40px 0px 20px" class="form-group has-info">
                <label class="control-label">Por favor indique el email del usuario cliente a consultar: </label>
                <input  style="margin:0px 10px 0px 10px; width: 50%; display: inline-block" ng-model="userEmail" type="text" class="form-control" required>
                <button style="display: inline-block" ng-click="vm.searchUser(userEmail)" class="btn btn-sm btn-info">Consultar</button>
              </div>

              <ul ng-show="vm.logClient">
                <li>
                  <strong> Nombre del cliente: </strong>{{vm.logClient.user}}
                  <br/>
                </li>
                <li>
                  <strong> Último registro: </strong>{{vm.logClient[vm.logClient.tamano-1].description}}, {{vm.logClient[vm.logClient.tamano-1].created | date:'medium'}}
                </li>
                <br/>
              </ul>

              <table ng-show="vm.logClient" class="table table-hover">
                <thead>
                <tr>
                  <th>Identificador</th>
                  <th>Fecha</th>
                  <th>Acción</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="log in vm.logClient">
                  <td>{{log._id}}</td>
                  <td>{{log.created | date:'medium'}}</td>
                  <td>{{log.description}}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="tab-pane" id="network">
          <div class="force-overflow">
            <div style="margin: 0px 40px 0px 20px" class="form-group has-info">
              <label class="control-label">Por favor indique el código identificador de la unidad de atención a consultar: </label>
              <input  style="margin:0px 10px 0px 10px; width: 50%; display: inline-block" ng-model="networkID" type="text" class="form-control" required>
              <button style="display: inline-block" ng-click="vm.searchNetwork(networkID)" class="btn btn-sm btn-info">Consultar</button>
            </div>
            <ul ng-show="vm.networkSearch">
              <li>
                <strong> Fecha registro de la unidad: </strong>{{vm.networkSearch[0].created | date:'medium'}}
                <br/>
              </li>
              <li>
                <strong> Responsable actualmente: </strong>{{vm.networkSearch[0].serviceUser}}
                <br/>
              </li>
            </ul>

            <table ng-show="vm.logNetwork.length != 0" class="table table-hover">
              <thead>
              <tr>
                <th>Fecha</th>
                <th>Cliente</th>
                <th>Acción</th>
              </tr>
              </thead>
              <tbody>
              <tr ng-repeat="log in vm.logNetwork">
                <td>{{log.created | date:'medium'}}</td>
                <td>{{log.clientEmail}}</td>
                <td>{{log.description}}</td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="tab-pane" id="periodo">
          <div class="force-overflow">

            <div class="col-md-4">

            </div>
            <div class="col-md-2">
              <select ng-model="date" class="form-control">
                <option value="{{1}}" selected>Hoy</option>
                <option value="{{2}}">Los últimos 7 días</option>
                <option value="{{3}}">Este mes</option>
                <option value="{{4}}">El mes pasado</option>
              </select>
            </div>
            <div class="col-md-2">
              <button ng-click="vm.searchLog(date)" class="btn btn-sm btn-info">Consultar</button>
            </div>

            <table ng-show="vm.logPeriod.length" class="table table-hover">
              <thead>
              <tr>
                <th>Identificador</th>
                <th>Fecha</th>
                <th>Acción</th>
              </tr>
              </thead>
              <tbody>
              <tr ng-repeat="log in vm.logPeriod">
                <td>{{log._id}}</td>
                <td>{{log.created | date:'medium'}}</td>
                <td>{{log.description}}</td>
              </tr>
              </tbody>
            </table>

          </div>

        </div>
        <div class="tab-pane" id="networksAll">
          <ul>
            <li ng-show="vm.networks" ng-repeat="network in vm.networks ">
              Cógido identificador de la unidad: {{network.carCode}}
              <br/>
              <strong>Fecha de registro de la unidad:</strong> {{network.created | date:'medium'}}
              <br/>
              Actualmente:
              <br/>
              <ul>
                <li>
                  <strong>Status:</strong> {{network.status}} -
                  <strong>Ubiación:</strong> ({{network.latitude}} , {{network.longitude}})
                </li>
              </ul>

              <br/><br/>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>
